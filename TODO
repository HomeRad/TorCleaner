- Get the proxy to work with Opera and IE

- Preserve self.attr for HttpClient/HttpServer.py

- The "connect error connection refused" message could be improved.
  Here is what firefox displays:

  Unable to connect
  Firefox can't establish a connection to the server at gentoo-wiki.com.
  * The site could be temporarily unavailable or too busy. Try again in a few
    moments.
  * If you are unable to load any pages, check your computer's network
    connection.
  * If your computer or network is protected by a firewall or proxy, make sure
    that Firefox is permitted to access the Web.

- Think about using python-adns instead of the dnspython stuff.

- Ajax-enabled web gui theme:
  Since we require JavaScript for this theme, lots of goodies can be realized.
  + no delete confirmation
    http://www.d3eministry.net/wordpress/2006/03/23/147/
  + inline editing
    http://24ways.org/advent/edit-in-place-with-ajax
  + zebra tables
    http://www.alistapart.com/articles/zebratables/

- Design improvments:
  + rounded corners
    http://www.spiffycorners.com/

- web gui authentication improvements:
  see http://www.berenddeboer.net/rest/authentication.html
  This will have to be tested for proxy-authentication.

- Add parent proxy support to SSL gateway.

- test HTTP pipelining (esp. the order of the responses)

- Check the order in which client (or server) headers are mangled,
  especially hop-by-hop header removal. Simplify the header mangling.

- Add more HTTP RFC2616 unit tests.

- Add support for https JS urls background download.

- If an unknown port is forbidden (403 status), add an explaining message.

- HTML parser should recognize a missing ending quote of attribute values.
  Right now the parser parses all subsequent stuff as TEXT.
  A solution:
  If end-of-line is encountered during attribute value scanning, assume
  a missing end quote.
  Now roll back the scanner to the first white-space or '>' character
  after the beginning quote, and assume the missing end quote at this
  position.
  Does catch stuff like <a b="c>, and even <a b="c d="e">. Does not catch
  things like <a b="Mr. Smith href="foo">, but that would be ok for now.
  
- Use HTML parser with Unicode support, ie. rewrite this bugger in Python
  with regexes (slow?).
  
- Mac OS X and BSD support for network interface list:
  from the www.dents.org C source (GPL license):
  /* Loop through all of the interfaces, getting the IP address for each */
  for (i = 0; i < ifc.ifc_len;) {
    ifr = (struct ifreq *)((u_char *) ifc.ifc_req + i);

    /* For some reason BSD has to be difficult */
#ifdef HAVE_SA_LEN
    i += sizeof(ifr->ifr_name) +
      (ifr->ifr_addr.sa_len > sizeof(struct sockaddr)
       ? ifr->ifr_addr.sa_len : sizeof(struct sockaddr));
#else
    i += sizeof(struct ifreq);
#endif

    /* Make sure it's an AF_INET address. This is mostly to cover the BSD's */
    /* which send AF_LINK interface's back as well. */
    if (ifr->ifr_addr.sa_family != AF_INET)
        continue;

- squid uses an external auth configuration, we could use that too

- JavaScript evaluation stops on errors. This is bad since some errors
  (like external frame references) cannot be avoided.
  A workaround would be to generate JS objects that have _all_
  properties by overloading the property getter.

- SSL certificate verification.

- Memory is not freed while operating the proxy.

- Allow filtering/blocking by MIME type.

- bfilter has Flash parse and generation library, I want that too .)

- test NTLM authentication
  Mozilla >= 1.6b can test NTLM server auth, squid can test client auth

- NTLM: restore old method type when method was not GET

- NTLM: reconnect to parent proxy after first 407 error (squid closes
  the connection)

- unicode parsing for flex
  the HTML parser (written with flex) does not support unicode, so
  sometimes you'll see '?' chars in the HTML output.

- IPv6 support (there are some stubs already, but untested, and DNS
  library is missing IPv6 support)
  Big problem: how do we decide when to send out IPv6 DNS queries?

- Streaming clamav scanning, try to detect virii immediately
  Note: clamav does _not_ support streaming, so this is currently not
  possible. We have to wait until all data is received, then scan it,
  and only after that we can be sure the data is virus-clean.

- Remove all comments from JavaScript: use spidermonkey scanner, and
  reconstruct the script with token data.

- Traceback (most recent call last):
  File "webcleaner", line 198, in ?
    main(sys.argv[1:])
  File "webcleaner", line 194, in main
    return _main(configdir, filelogs, args)
  File "webcleaner", line 159, in main_posix
    wc.start.wstartfunc(confdir=configdir, filelogs=filelogs)
  File "/home/calvin/src/webcleaner/wc/start.py", line 72, in wstartfunc
    wc.proxy.mainloop(handle=handle, abort=abort)
  File "/home/calvin/src/webcleaner/wc/proxy/__init__.py", line 166, in mainloop
    proxy_poll(timeout=max(0, run_timers()))
  File "/home/calvin/src/webcleaner/wc/proxy/__init__.py", line 136, in proxy_poll
    x.handle_read_event()
  File "/home/calvin/src/webcleaner/wc/proxy/Dispatcher.py", line 429, in handle_read_event
    self.handle_read()
  File "/home/calvin/src/webcleaner/wc/proxy/Connection.py", line 117, in handle_read
    self.process_read()
  File "/home/calvin/src/webcleaner/wc/proxy/HttpServer.py", line 217, in process_read
    if self.delegate_read():
  File "/home/calvin/src/webcleaner/wc/proxy/StatefulConnection.py", line 63, in delegate_read
    getattr(self, 'process_'+self.state)()
  File "/home/calvin/src/webcleaner/wc/proxy/HttpServer.py", line 538, in process_recycle
    self.delayed_close()
  File "/home/calvin/src/webcleaner/wc/proxy/Connection.py", line 211, in delayed_close
    if not self.close_ready():
  File "/home/calvin/src/webcleaner/wc/proxy/HttpServer.py", line 617, in close_ready
    if not self.flush():
  File "/home/calvin/src/webcleaner/wc/proxy/HttpServer.py", line 569, in flush
    self.client.server_content(data)
  AttributeError: 'ClientServerMatchmaker' object has no attribute 'server_content'

- If the template system ever gets replaced, have a look at
  http://kid.lesscode.org/


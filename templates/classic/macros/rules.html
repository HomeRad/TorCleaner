<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<link href="../wc.css" type="text/css" rel="Stylesheet">
<title>Rule macros</title>
</head>
<body>
<div class="content">
<h1>Rule macros...</h1>
<!-- macro definitions for rule editing
  Note: the TAL contexts from the calling templates are used here
 -->

<!-- title and description (used below) -->
<h2>Title and description</h2>
<table>
<div metal:define-macro="titledesc">
<tr><td>
<label for="rule_title" tal:content="t_ruletitle">Title</label>:
</td><td>
<input type="text" class="text" name="rule_title" id="rule_title"
 value="Rule title" tal:attributes="value currule/title">
</td></tr>
<tr><td>
<label for="rule_description" tal:content="t_ruledescription">Description</label>:
</td><td>
<textarea name="rule_description" id="rule_description" cols="50" rows="5"
 tal:content="currule/desc">Rule description</textarea>
</td></tr>
</div>
</table>
<hr noshade size="1">

<!-- matchurl and dontmatchurl (used below) -->
<h2>Match url</h2>
<table>
<div metal:define-macro="matchurl">
<tr><td>
<label for="rule_matchurl" tal:content="t_rulematchurl">Match URL</label>:
</td><td>
<input type="text" class="text" name="rule_matchurl" id="rule_matchurl"
 value="Match url" tal:attributes="value currule/matchurl">
</td></tr>
<tr><td>
<label for="rule_dontmatchurl" tal:content="t_ruledontmatchurl">Don't match URL</label>:
</td><td>
<input type="text" class="text" name="rule_dontmatchurl" id="rule_dontmatchurl"
 value="Don't match url" tal:attributes="value currule/dontmatchurl">
</td></tr>
</div>
</table>
<hr noshade size="1">

<!-- url parts (used by AllowRule and BlockRule) -->
<h2>Url parts</h2>
<table>
<div metal:define-macro="urlparts">
<tr><td>
<label for="rule_urlscheme" tal:content="t_ruleurlscheme">URL scheme</label>:
</td><td>
<input type="text" class="text" name="rule_urlscheme" value="http"
 tal:attributes="value currule/scheme">
</td></tr>
<tr><td>
<label for="rule_urlhost" tal:content="t_ruleurlhost">URL host</label>:
</td><td>
<input type="text" class="text" name="rule_urlhost" value="www.imadoofus.com"
 tal:attributes="value currule/host">
</td></tr>
<tr><td>
<label for="rule_urlport" tal:content="t_ruleurlport">URL port</label>:
</td><td>
<input type="text" class="text" name="rule_urlport" value="80"
 tal:attributes="value currule/port">
</td></tr>
<tr><td>
<label for="rule_urlpath" tal:content="t_ruleurlpath">URL path</label>:
</td><td>
<input type="text" class="text" name="rule_urlpath" value="/hulla/bulla"
 tal:attributes="value currule/path">
</td></tr>
<tr><td>
<label for="rule_urlparameters" tal:content="t_ruleurlparameters">URL parameters</label>:
</td><td>
<input type="text" class="text" name="rule_urlparameters" value=""
 tal:attributes="value currule/parameters">
</td></tr>
<tr><td>
<label for="rule_urlquery" tal:content="t_ruleurlquery">URL query</label>:
</td><td>
<input type="text" class="text" name="rule_urlquery" value=""
 tal:attributes="value currule/query">
</td></tr>
<tr><td>
<label for="rule_urlfragment" tal:content="t_ruleurlfragment">URL fragment</label>:
</td><td>
<input type="text" class="text" name="rule_urlfragment" value=""
 tal:attributes="value currule/fragment">
</td></tr>
</div>
</table>
<hr noshade size="1">

<!-- externfile (used by Allowdomains, Allowurls, Blockdomains, Blockurls) -->
<h2>Extern file</h2>
<table>
<div metal:define-macro="externfile">
<tr><td>
<span tal:replace="t_ruletitle">Title</span>:
</td><td>
<span tal:replace="currule/title">rule title</span>
</td></tr>
<tr><td>
<span tal:replace="t_ruledescription">Description</span>:
</td><td>
<span tal:replace="currule/desc">rule description</span>
</td></tr>
<tr><td>
<span tal:replace="t_rulefile">File</span>:
</td><td>
<span tal:replace="currule/file">/path/to/file</span>
</td></tr>
</div>
</table>
<hr noshade size="1">


<!-- Rule macros, each in a table tag -->

<!-- AllowRule -->
<h2>Allowrule</h2>
<table metal:define-macro="allow">
<tr metal:use-macro="rulemacros/macros/titledesc">
Rule title and description
</tr>
<tr metal:use-macro="rulemacros/macros/urlparts">
Rule url parts
</tr>
<tr><td colspan="2">
<input type="submit" class="submit" name="apply" value="Apply"
 tal:attributes="value t_apply">
</td></tr>
</table>
<hr noshade size="1">

<!-- Allowdomains -->
<h2>Allowdomains</h2>
<table metal:define-macro="allowdomains">
<tr metal:use-macro="rulemacros/macros/externfile">
Extern file name allowdomains
</tr>
</table>
<hr noshade size="1">

<!-- Allowurls -->
<h2>Allowurls</h2>
<table metal:define-macro="allowurls">
<tr metal:use-macro="rulemacros/macros/externfile">
Extern file name allowurls
</tr>
</table>
<hr noshade size="1">

<!-- Blockdomains -->
<h2>Blockdomains</h2>
<table metal:define-macro="blockdomains">
<tr metal:use-macro="rulemacros/macros/externfile">
Extern file name blockdomains
</tr>
</table>
<hr noshade size="1">

<!-- Blockurls -->
<h2>Blockurls</h2>
<table metal:define-macro="blockurls">
<tr metal:use-macro="rulemacros/macros/externfile">
Extern file name blockurls
</tr>
</table>
<hr noshade size="1">

<!-- BlockRule -->
<h2>BlockRule</h2>
<table metal:define-macro="block">
<tr metal:use-macro="rulemacros/macros/titledesc">
Rule title and description
</tr>
<tr metal:use-macro="rulemacros/macros/urlparts">
Rule url parts
</tr>
<tr><td>
<label for="rule_blockedurl" tal:content="t_ruleblockedurl">Blocked URL</label>:
</td><td>
<input type="text" class="text" name="rule_blockedurl" id="rule_blockedurl"
 value="http://www.calvinandhobbes.com/" tal:attributes="value currule/url">
</td></tr>
<tr><td colspan="2">
<input type="submit" class="submit" name="apply" value="Apply"
 tal:attributes="value t_apply">
</td></tr>
</table>
<hr noshade size="1">

<!-- HeaderRule -->
<h2>HeaderRule</h2>
<table metal:define-macro="header">
<tr metal:use-macro="rulemacros/macros/titledesc">
Rule title and description
</tr>
<tr metal:use-macro="rulemacros/macros/matchurl">
Rule (don't) match url
</tr>
<tr><td>
<label for="rule_headername" tal:content="t_ruleheadername">Header name</label>:
</td><td>
<input type="text" class="text" name="rule_headername" id="rule_headername"
 value="x-meta" tal:attributes="value currule/name">
</td></tr>
<tr><td>
<label for="rule_headervalue" tal:content="t_ruleheadervalue">Header value</label>:
</td><td>
<input type="text" class="text" name="rule_headervalue" id="rule_headervalue"
 value="" tal:attributes="value currule/value">
</td></tr>
<tr><td colspan="2">
<input type="submit" class="submit" name="apply" value="Apply"
 tal:attributes="value t_apply">
</td></tr>
</table>
<hr noshade size="1">

<!-- ImageRule -->
<h2>ImageRule</h2>
<table metal:define-macro="image">
<tr metal:use-macro="rulemacros/macros/titledesc">
Rule title and description
</tr>
<tr metal:use-macro="rulemacros/macros/matchurl">
Rule (don't) match url
</tr>
<tr><td>
<label for="rule_imgwidth" tal:content="t_ruleimgwidth">Image width</label>:
</td><td>
<input type="text" class="number" name="rule_imgwidth" id="rule_imgwidth"
 value="1" tal:attributes="value string:${currule/width}">
</td></tr>
<tr><td>
<label for="rule_imgheight"  tal:content="t_ruleimgheight">Image height</label>:
</td><td>
<input type="text" class="number" name="rule_imgheight" id="rule_imgheight"
 value="1" tal:attributes="value string:${currule/height}">
</td></tr>
<!-- XXX todo: image type select -->
<tr><td>
<label for="rule_imgurl" tal:content="t_ruleimgurl">Blocked image URL</label>:
</td><td>
<input type="text" class="text" name="rule_imgurl" id="rule_imgurl"
 value="myblocked.gif" tal:attributes="value currule/url">
</td></tr>
<tr><td colspan="2">
<input type="submit" class="submit" name="apply" value="Apply"
 tal:attributes="value t_apply">
</td></tr>
</table>
<hr noshade size="1">

<!-- JavascriptRule -->
<h2>JavascriptRule</h2>
<table metal:define-macro="javascript">
<tr metal:use-macro="rulemacros/macros/titledesc">
Rule title and description
</tr>
<tr metal:use-macro="rulemacros/macros/matchurl">
Rule (don't) match url
</tr>
<tr><td colspan="2">
<input type="submit" class="submit" name="apply" value="Apply"
 tal:attributes="value t_apply">
</td></tr>
</table>
<hr noshade size="1">

<!-- NocommentsRule -->
<h2>NocommentsRule</h2>
<table metal:define-macro="nocomments">
<tr metal:use-macro="rulemacros/macros/titledesc">
Rule title and description
</tr>
<tr metal:use-macro="rulemacros/macros/matchurl">
Rule (don't) match url
</tr>
<tr><td colspan="2">
<input type="submit" class="submit" name="apply" value="Apply"
 tal:attributes="value t_apply">
</td></tr>
</table>
<hr noshade size="1">

<!-- PicsRule -->
<h2>PicsRule</h2>
<table metal:define-macro="pics">
<tr metal:use-macro="rulemacros/macros/titledesc">
Rule title and description
</tr>
<tr metal:use-macro="rulemacros/macros/matchurl">
Rule (don't) match url
</tr>
<tr><td>
<label for="rule_fallback" tal:content="t_rulefallback">Fallback URL</label>:
</td><td>
<input type="text" class="text" name="rule_fallback" id="rule_fallback"
 value="http://www..." tal:attributes="value currule/url">
</td></tr>
<tr><td>
<span tal:replace="t_picsratings">Pics ratings</span>:
</td><td>
<div tal:repeat="service pics_services">
<input tal:condition="currule/ratings/?service"
 type="checkbox" tal:attributes="name string:service_${service}" checked >
<input tal:condition="not:currule/ratings/?service"
 type="checkbox" tal:attributes="name string:service_${service}">
<span tal:content="t_service">Service</span>
<span tal:content="pics_data/?service/name">Netnanny</span>
<br>
<div tal:condition="currule/ratings/?service"
 tal:repeat="category pics_categories/?service"
 style="margin-left:30px;">
<input tal:condition="currule/ratings/?service/?category"
 type="checkbox" checked
 tal:attributes="name string:category_${service}_${category}">
<input tal:condition="not:currule/ratings/?service/?category"
 type="checkbox"
 tal:attributes="name string:category_${service}_${category}">
<span tal:content="t_category">Category</span>
<span tal:content="category">adult</span>
</div>
</div>
</td>
</tr>
<tr>
<td colspan="2">
<input type="submit" class="submit" name="apply" value="Apply"
 tal:attributes="value t_apply">
</td>
</tr>
</table>
<hr noshade size="1">

<!-- ReplaceRule -->
<h2>ReplaceRule</h2>
<table metal:define-macro="replace">
<tr metal:use-macro="rulemacros/macros/titledesc">
Rule title and description
</tr>
<tr metal:use-macro="rulemacros/macros/matchurl">
Rule (don't) match url
</tr>
<tr><td>
<label for="rule_search" tal:content="t_rulesearch">Replace search regex</label>:
</td><td>
<input type="text" class="text" name="rule_search" id="rule_search"
 value="A nasty word" tal:attributes="value currule/search">
</td></tr>
<tr><td>
<label for="rule_replace" tal:content="t_rulereplace">Replacement</label>:
</td><td>
<input type="text" class="text" name="rule_replace" id="rule_replace"
 value="Something good" tal:attributes="value currule/replace">
</td></tr>
<tr>
<td colspan="2">
<input type="submit" class="submit" name="apply" value="Apply"
 tal:attributes="value t_apply">
</td></tr>
</table>
<hr noshade size="1">

<!-- RewriteRule -->
<h2>RewriteRule</h2>
<table metal:define-macro="rewrite">
<tr metal:use-macro="rulemacros/macros/titledesc">
<td>Rule title and description</td>
</tr>
<tr metal:use-macro="rulemacros/macros/matchurl">
<td>Rule (don't) match url</td>
</tr>
<tr><td>
<label for="rule_tag" tal:content="t_ruletag">Tag name</label>:
</td><td>
<input type="text" class="text" name="rule_tag" id="rule_tag" value="img"
 tal:attributes="value currule/tag">
</td></tr>
<tr><td>
<span tal:content="t_ruleattrs">Attributes</span>:
</td><td>
<table rules="cols" cellpadding="2">
<thead>
<tr style="border-bottom:1px solid black;">
<td>&nbsp;</td>
<th tal:content="t_attrname">Name</th>
<th tal:content="t_attrval">Value</th>
</tr>
</thead>
<tbody>
<tr tal:repeat="attr currule/attrs/keys">
<td><input type="checkbox" name="delattr"
 tal:attributes="value attr">
</td>
<td tal:content="attr">href</td>
<td><div tal:content="currule/attrs/?attr" style="width:180px;overflow:auto;">bla</div></td>
</tr>
<tr tal:condition="not:currule/attrs">
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
<span tal:condition="currule/attrs">
<input type="submit" class="submit" name="removeattrs" value="Remove selected"
 tal:attributes="value t_removeattrs">
</span>
</td></tr>
<tr><td>
<label for="attrname" tal:content="t_attrname">Name</label>:
</td><td>
<input type="text" class="text" name="attrname" id="attrname" value="href">
</td></tr>
<tr><td>
<label for="attrval" tal:content="t_attrval">Value</label>:
</td><td>
<input type="text" class="text" name="attrval" id="attrval" value="">
</td></tr>
<tr><td>&nbsp;</td>
<td><input type="submit" class="submit" name="addattr" value="Add attribute"
 tal:attributes="value t_addattr">
</td></tr>
<tr><td>
<label for="rule_enclosedblock" tal:replace="t_enclosedblock">Enclosed block</label>:
</td><td>
<input type="text" class="text" name="rule_enclosedblock"
 id="rule_enclosedblock" value="" tal:attributes="value currule/enclosed">
</td></tr>
<tr><td>
<label for="rule_rewritepart" tal:replace="t_replacepart">Replace part</label>:
</td><td>
<select name="rule_rewritepart">
<span tal:repeat="part partvalnames" tal:omit-tag="">
<option tal:condition="not:curparts/?part"
 tal:attributes="value part" tal:content="partnames/?part">a part</option>
<option tal:condition="curparts/?part" selected
 tal:attributes="value part" tal:content="partnames/?part">a part</option>
</span>
</select>
</td></tr>
<tr><td>
<label for="rule_rewritereplacement" 
 tal:replace="t_replacevalue">Replace value</label>:
</td><td>
<input type="text" class="text" name="rule_rewritereplacement" value=""
 id="rule_rewritereplacement" tal:attributes="value currule/replacement">
</td></tr>
<tr><td colspan="2">
<input type="submit" class="submit" name="apply" value="Apply"
 tal:attributes="value t_apply">
</td></tr>
</table>
<hr noshade size="1">

</body>
</html>
